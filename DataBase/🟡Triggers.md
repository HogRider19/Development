Триггер является указанием, что база данных должна автоматически выполнить заданную функцию, всякий раз когда выполнен определённый тип операции. Триггеры можно использовать с таблицами, с представлениями и с внешними таблицами.

Для обычных и сторонних таблиц можно определять триггеры, которые будут срабатывать до или после любой из команд `INSERT`, `UPDATE` или `DELETE`, либо один раз для каждой модифицируемой строки, либо один раз для оператора SQL.

Триггеры на `UPDATE` можно установить так, чтобы они срабатывали, только когда в предложении `SET` оператора `UPDATE` упоминаются определённые столбцы. 

Триггерная функция должна быть создана до триггера. Она должна быть объявлена без аргументов и возвращать тип `trigger`. Она получает данные на вход посредством специально переданной структуры `TriggerData`, а не в форме обычных аргументов.

После создания триггерной функции создаётся триггер с помощью CREATE TRIGGER. Одна и та же триггерная функция может быть использована для нескольких триггеров.

PostgreSQL предлагает как построчные, так и операторные триггеры. В случае построчного триггера триггерная функция вызывается один раз для каждой строки, которая была затронута оператором, который отслеживается триггером.

Операторный же триггер, напротив, вызывается только один раз при выполнении соответствующего оператора, независимо от количества строк, которые он охватывает. Эти два типа триггеров также называют триггерами уровня строк и уровня оператора.

Триггеры также классифицируются в соответствии с тем, срабатывают ли они до или после операции. Они называются триггерами `BEFORE` и `AFTER`, соответственно. 

Триггеры `BEFORE` уровня оператора срабатывают до того, как оператор начинает делать что-либо, тогда как триггеры `AFTER` уровня оператора срабатывают в конце. 

Триггеры `BEFORE` уровня строки срабатывают перед обработкой конкретной строки, в то время как триггеры `AFTER` уровня строки срабатывают в конце работы всего оператора но до любого из триггеров `AFTER` уровня оператора.

Триггер выполняется в рамках той же транзакции, что и вызывающий его оператор, поэтому если или оператор, или триггер вызывает ошибку, оба действия отменяются.

В рамках триггерной функции триггера уровня строк, можно получить предыдущее состояние строки через `NEW` и последующее состояние через `OLD`. 

Триггерные функции операторов, должны всегда возвращать `NULL`. Триггерные функции, вызываемые триггерами строк, могут вернуть строку таблицы. У триггера уровня строки, срабатывающего до операции, есть следующий выбор:

**==NULL==**. Можно вернуть `NULL`, чтобы пропустить операцию для текущей строки. Это указывает исполнителю запросов, что не нужно выполнять операцию со строкой вызвавшей триггер: вставку, изменение или удаление конкретной строки в таблице.

**==TUPLE==**. Можно вернуть новую строку для триггеров `INSERT` или `UPDATE`, которая будет вставлена или обновлена в таблице. Это позволяет триггерной функции изменять вставляемую или обновляемую строку при срабатывании триггера.

Если в триггере `BEFORE` уровня строки не планируется использовать любой из этих вариантов, то нужно вернуть ту же строку, которая была передана на вход то есть строку `NEW` для триггеров `INSERT` и `UPDATE`, или строку `OLD` для триггеров `DELETE`.

Возвращаемое значение игнорируется для триггеров уровня строки, вызываемых после операции, поэтому они могут всегда возвращать `NULL`.

В определении триггера можно указать логическое условие `WHEN`, которое будет проверяться, чтобы посмотреть, нужно ли запускать триггер. В триггерах уровня строки в условии `WHEN` можно проверять старые или новые значения столбцов строки.

Как правило, триггеры `BEFORE` уровня строки используются для проверки или модификации данных, которые будут вставлены или изменены. Например, можно использовать их для вставки текущего времени в столбец или проверки, что два элемента строки согласованы между собой, то есть для сложных ограничений.

Триггеры `AFTER` уровня строки можно использовать для каскадного обновления данных в других таблицах или проверки согласованности сделанных изменений. Для этого используется `AFTER`, так как он видит окончательное значение строки, в то время как `BEFORE` нет, ведь могут быть другие триггеры `BEFORE`, которые сработают позже.

Если нет особых причин для выбора между триггерами `BEFORE` или `AFTER`, то триггер `BEFORE` предпочтительнее, так как не требует сохранения информации об операции.

Если триггерная функция выполняет команды, эти команды могут заново запускать триггеры. Это известно как каскадные триггеры. Нет ограничений на глубину каскада.

```sql
CREATE TRIGGER trigger_name [BEFORE/AFTER] [COMAND] ON table_name
[FOR EACH ROW] EXECUTE FUNCTION function;
```