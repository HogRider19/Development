**Транзакция** - представляет собой последовательность операторов языка SQL, которая рассматривается как некоторое неделимое действие над базой данных, осмысленное с точки зрения пользователя. В то же время, это логическая единица работы системы

**SET TRANSACTION** - устанавливает характеристики текущей транзакции. На последующие транзакции она не влияет

**PostgreSQL** не поддерживает уровень изоляции **read uncommitted**, и использует вместо него уровень **read committed**

В **MySQL** отсутствует эффект **чтения фантомов** для уровня **repeatable read**. И в **PostgreSQL** от него тоже избавились для этого уровня. Хотя в классическом представлении этого уровня, мы должны наблюдать этот эффект

## Проблемы параллельности транзакций:

- **Грязное чтение** - чтение данных, добавленных или изменённых транзакцией, которая впоследствии не подтвердится (откатится) 
- **Неповторяемое чтение** — после чтения данных одной транзакцией, вторая транзакция изменяет(UPDATE) и согласовывает данные первой транзакции, в результате первая транзакция работает с не валидными данными 
- **Фантомное чтение** - тоже самое, что и неповторяемое чтение, только с изменением результирующего набора, то есть вторая транзакция вставляет новые поля или удаляет имеющиеся 
- **Аномалия сериализации** — при одновременном изменении одного блока данных разными транзакциями теряются все изменения, кроме последнего

## Уровни изоляций транзакций:

- **Read uncommitted** - каждая транзакция видит незафиксированные изменения другой транзакции (феномен грязного чтения) 
- **Read committed** - Для этого уровня параллельно исполняющиеся транзакции видят только зафиксированные изменения из других транзакций. Таким образом, данный уровень обеспечивает защиту от грязного чтения 
- **Repeatable read** - уровень, позволяющий предотвратить феномен неповторяющегося чтения. Т.е. мы не видим в исполняющейся транзакции измененные и удаленные записи другой транзакцией. Но все еще видим вставленные записи из другой транзакции. Чтение фантомов никуда не уходит 
- **Serializable** - Уровень, при котором транзакции ведут себя как будто ничего более не существует, никакого влияния друг на друга нет. В классическом представлении этот уровень избавляет от эффекта чтения фантомов и аномалии сериализации

## Свойства транзакций:

- **Atomicity (атомарность)** — выражается в том, что транзакция должна быть выполнена в целом или не выполнена вовсе.
- **Consistency (согласованность)** — гарантирует, что по мере выполнения транзакций, данные переходят из одного согласованного состояния в другое, то есть транзакция не может разрушить взаимной согласованности данных. 
- **Isolation (изолированность)** — локализация пользовательских процессов означает, что конкурирующие за доступ к БД транзакции физически обрабатываются последовательно, изолированно друг от друга, но для пользователей это выглядит, как будто они выполняются параллельно. 
- **Durability (долговечность)** — устойчивость к ошибкам — если транзакция завершена успешно, то те изменения в данных, которые были ею произведены, не могут быть потеряны ни при каких обстоятельствах

[![](https://yougile.com/user-data/7d18f0f6-0a05-4c73-a338-7809ac0927ae/Уровни_изоляций-preview.png)](https://yougile.com/user-data/7d18f0f6-0a05-4c73-a338-7809ac0927ae/Уровни_изоляций.png)