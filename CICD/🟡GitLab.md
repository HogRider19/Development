Система `CI/CD` в `GitLab` одна из наиболее популярных, масштабируемых и гибких систем используемых в компаниях по всему миру. Он позволяет бесплатно получить систему, по функциональности достигающую уровня коммерческих сервисов.

Настройка Pipline в GitLub происходит через файл `.gitlab-ci.yml` в репозитории. С помощью него описываются все этапы сборки, тестирования и развертывания проекта. Он размещается в корневой папке проекта и написан на языке разметки `YAML`.

Файл конфигурации состоит из нескольких секций, которые определяют различные аспекты `Pipline`. У каждый секции файла своя функция, выполняющаяся в `CI/CD`.

Все `Pipline` запускаются специальными сервисами `GitLubRunnder`. Платформа `GitLab`
бесплатно предоставляет `GitLubRunnder` на своем сервере, но если требуется большая гибкость или большая скорость работы, его можно запустить на своем сервере.

Новые `Runnder` добавляются в настройках проекта в вкладке `CI/CD`. Сам `Runnder` можно напрямую установить на свой сервер или поднять в контейнере `Docker`. 

**==Stages==**. Этапы определяют порядок выполнения различных групп задач и делают так, чтобы они выполнялись последовательно. А еще этапы помогают организовать задачи  в группы по функциональному смыслу: например сборка, тестирование, развертывание.

```yml
stages:
  - build
  - test
  - deploy
```

**==Job==**. Это часть `Pipline`, которая дает инструкции к выполнению задач в этапах. Задачи в пределах одного этапа будут запускаться параллельно, если нет обратных условий. Например, задача сборки компилирует код, а задача тестирования запускать тесты.

```yml
build_job:
  stage: build
  script:
    - echo "Сборка кода..."

test_job:
  stage: test
  script:
    - echo "Запуск тестов..."

deploy_job:
  stage: deploy
  script:
    - echo "Развертывание приложения..."
```

**==Script==**. Определяет набор команд, выполняющихся в одной задаче. Можно назвать эту часть конфигурации одной из самых важных, именно тут прописываются все команды, которые должны быть выполнены в пределах конкретно назначенной задачи.

```yml
build:
 image: ubuntu:24.04
 stage: build
 tags:
   - cloud-runner
 script:
   - docker build -t "image:tag" -t "image:latest" --push.
```

**==Before_script==**. Ключи `Before_script` и `after_script` определяют команды, которые выполняются до и после выполнения всех задач в `Pipline`. Например, перед выполнением задач можно войти в реестр `Docker`, а после выйти из него.

```yml
before_script:
   - docker login -u <username> -p ${password} index.docker.io
 after_script:
   - docker logout index.docker.io
```

**==Variables==**. С помощью этого элемента устанавливаются переменные окружения. Их можно использовать на каждом этапе `Pipline`. За счет переменных становится проще настраивать и управлять конфигурацией. Из самого простого: можно назначить переменную для `URL` базы данных, а затем использовать ее и в других задачах.

```yml
variables:
  DATABASE_URL: "postgres://user:password@hostname:5432/dbname"
```

**==Include==**. Дает возможность включить внешние `YAML` файлы, чтобы использовать конфигурации по нескольку раз. Это помогает управлять крупными `Pipline`. Например, можно использовать одну конфигурацию в нескольких проектах или разделить крупный файл конфигурации на несколько частей и переиспользовать их.

```yml
include:
  - project: 'my-group/my-project'
    ref: master
    file: '/templates/.template.yml'
  - local: '/ci/common.yml'
```

**==Artifacts==**. Элемент `Artifacts` это сохраняемые файлы, которые создаются во время выполнения задачи. Их можно использовать повторно в других задачах. Так, можно сохранить результаты тестов или передать скомпилированные файлы между задачами.

```yml
artifacts:
  paths:
    - build/
  expire_in: 1 week
```

**==Cache==**. Дает возможность сохранить в кэше зависимости или любые иные сложно воспроизводимые данные, созданные во время выполнения задач. С помощью этой функции можно ускорить выполнения за счет переиспользования полученных данных.

```yml
cache:
  paths:
    - project-venv
```

**==Image==**. Указывает образ контейнера, который будет использоваться для выполнения задачи. Это заранее настроенное окружение с установленными зависимостями. Например, можно использовать образ с установленной версией `Ruby`.

```yml
image: ruby:2.7
```

**==Services==**. Позволяют запускать дополнительные контейнеры, которые нужны для выполнения задач, например, базы данных. Элемент помогает в тестировании,
когда для работы приложения требуется наличие внешнего сервиса.

```yml
services:
  - mysql:9
```

**==Only==**. Ключи `only` и `except` выделяют условия для выполнения или пропуска задач. Например, задачи могут выполняться только на определённых ветках репозитория
или, наоборот, пропускаться для определенных веток или определенных тегов.

```yml
only:
  - master
  - develop
except:
  - v.*
```

**==Tags==**. Теги используются для определения, какие `GitLab Runner` будут запускать задачи. Это помогает распределять задачи по агентам в зависимости от их возможностей.

```yml
tags:
  - docker
  - linux
```

**==Environment==**. Окружение управляет развертыванием задач в определенные среды, например. Это помогает разворачивать и тестировать код в различных условиях.

```yml
environment:
  name: production
  url: https://prod.example.com
```

**==Interruptible==**. Этот ключ позволяет прерывать задачи, если запускается новая сборка. Это полезно для экономии ресурсов, когда более старая сборка уже не актуальна.

```yml
build:
  stage: build
  script:
    - echo "This build can be canceled."
  interruptible: true
```