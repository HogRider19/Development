–í–∞–∂–Ω–æ–µ –º–µ—Å—Ç–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–∞–Ω–∏–º–∞–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è¬†–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –∏–º–µ–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∞–≤–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º—É —Ä–µ—Å—É—Ä—Å—É. –°–∏—Å—Ç–µ–º–∞
`AspNetCore` –∏–º–µ–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

![[Pasted image 20250702220444.png]]

---

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –∫–æ–Ω–≤–µ–π–µ—Ä–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç–≤–µ—á–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `middleware` ¬†`AuthenticationMiddleware`. –î–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è —ç—Ç–æ–≥–æ `middleware` –≤ –∫–æ–Ω–≤–µ–π–µ—Ä –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã¬†`UseAuthentication()`.

–°–ª–µ–¥—É–µ—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –º–µ—Ç–æ–¥¬†`UseAuthentication()`¬†–¥–æ–ª–∂–µ–Ω –≤—Å—Ç—Ä–∞–∏–≤–∞—Ç—å—Å—è –≤ –∫–æ–Ω–≤–µ–π–µ—Ä –¥–æ –ª—é–±—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ `middleware`, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —ç—Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ä–≤–∏—Å—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏¬†`IAuthenticationService`, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑¬†`AddAuthentication()`.

```c#
var builder = WebApplication.CreateBuilder();
builder.Services.AddAuthentication("Bearer") 
    .AddJwtBearer();
 
var app = builder.Build();
app.UseAuthentication();
```

–í –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤—Ç–æ—Ä–∞—è –≤–µ—Ä—Å–∏—è –º–µ—Ç–æ–¥–∞¬†`AddAuthentication()`¬†–ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—Ö–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏. –¢—Ä–µ—Ç—å—è –≤–µ—Ä—Å–∏—è –º–µ—Ç–æ–¥–∞ `AddAuthentication` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç
–¥–µ–ª–µ–≥–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–ø—Ü–∏–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç `AuthenticationOptions`.

–ö–∞–∫—É—é –±—ã –º—ã –≤–µ—Ä—Å–∏—é –º–µ—Ç–æ–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏, –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ö–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫ `Cookies` –∏ `Bearer`.
–û–¥–Ω–∞ —Ö—Ä–∞–Ω–∏—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤ –∫—É–∫–∞—Ö, –∞ –≤—Ç–æ—Ä–∞—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –µ–≥–æ –≤ `jwt` —Ç–æ–∫–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.    

–°—Ö–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏¬†–ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏¬†—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∏—Å—Ö–æ–¥—è –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ö–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é –∫—É–∫–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Å—Ö–µ–º–∞ `Cookies`.
–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ `Authentication.Cookies.CookieAuthenticationHandler`, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –≤ –∑–∞–ø—Ä–æ—Å–µ `cookie` –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.

–ê –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ö–µ–º–∞ `Bearer`, —Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è `jwt` —Ç–æ–∫–µ–Ω, –∞
–≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –∫–ª–∞—Å—Å `Authentication.JwtBearer.JwtBearerHandler`. –°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é `jwt` —Ç–æ–∫–µ–Ω–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç —á–µ—Ä–µ–∑ `Nuget` —Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –ø–∞–∫–µ—Ç¬†`Microsoft.AspNetCore.Authentication.JwtBearer`.

–ü—Ä–∏ —á–µ–º –≤ `AspNetCore` –º—ã –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ —Å—Ö–µ–º–∞–º–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ 
–º–æ–∂–µ–º —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏ –ø–æ–¥ –Ω–∏—Ö —Å–≤–æ–∏—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
–ö—Ä–æ–º–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞. –î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:

```c#
builder.Services.AddAuthentication("Bearer").AddJwtBearer();
builder.Services.AddAuthentication("Cookies").AddCookie();
```

–û–±–∞ –º–µ—Ç–æ–¥–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–∞–∫ –º–µ—Ç–æ–¥—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–ª—è `AuthenticationBuilder`, 
–∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤¬†`AddAuthentication()`.

---

–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º–µ,
–∫ –∫–∞–∫–∏–º —Ä–µ—Å—É—Ä—Å–∞–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–Ω –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ –¥–æ—Å—Ç—É–ø–∞ –∏ –ø—Ä–∏ –∫–∞–∫–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö.

–•–æ—Ç—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –ø—Ä–æ—Ü–µ—Å—Å, —Ç–µ–º –Ω–µ –º–µ–Ω–µ–µ 
–¥–ª—è –Ω–µ–µ —Ç–∞–∫–∂–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–∞–∫–∂–µ –ø—Ä–∏–º–µ–Ω—è–ª–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.

–î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `AuthorizationMiddleware`. –î–ª—è —ç—Ç–æ–≥–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è¬†`UseAuthorization()`.
–¢–∞–∫–∂–µ –Ω—É–∂–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é¬†`AddAuthorization()`.

–í—Ç–æ—Ä–∞—è –≤–µ—Ä—Å–∏—è –º–µ—Ç–æ–¥–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–µ–ª–µ–≥–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å –ø–æ–º–æ—â—å—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ
–æ–±—ä–µ–∫—Ç–∞ `AuthorizationOptions` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é. 

–ö–ª—é—á–µ–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ `AspNetCore` —è–≤–ª—è–µ—Ç—Å—è –∞—Ç—Ä–∏–±—É—Ç¬†`AuthorizeAttribute` , –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å–∞–º.

```c#
var builder = WebApplication.CreateBuilder();
 
builder.Services.AddAuthentication("Bearer").AddJwtBearer();    
builder.Services.AddAuthorization();           
 
var app = builder.Build();
 
app.UseAuthentication();
app.UseAuthorization();
 
app.Map("/hello", [Authorize]() => "Hello World!");
app.Map("/", () => "Home Page");
 
app.Run();
```

---
–û–¥–Ω–æ–π –∏–∑ –∑–∞–¥–∞—á –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ `AspNetCore` —è–≤–ª—è–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ –≤–∏–¥–µ —Å–≤–æ–π—Å—Ç–≤–∞¬†`User`¬†–∫–ª–∞—Å—Å–∞ `HttpContext`.

```c#
public abstract System.Security.Claims.ClaimsPrincipal User { get; set; }
```

–î–∞–Ω–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å¬†`ClaimsPrincipal`. –ù–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Å–≤–æ–π—Å—Ç–≤–µ¬†`Identity`¬†–∫–ª–∞—Å—Å–∞ `ClaimPrincipal`.

```c#
public virtual System.Security.Principal.IIdentity? Identity { get; }
```

–≠—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å. –ù–æ —Ç–∞–∫ –∫–∞–∫ —Å  –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –º–æ–∂–µ—Ç
–±—ã—Ç—å —Å–≤—è–∑–∞–Ω –Ω–∞–±–æ—Ä –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–µ–π, —Ç–æ —Ç–∞–∫–∂–µ –≤ –∫–ª–∞—Å—Å–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ¬†`Identities`.

```c#
public virtual IEnumerable<ClaimsIdentity> Identities { get; }
```

–°–≤–æ–π—Å—Ç–≤–æ `Identity` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å¬†`IIdentity`, –∏, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ç–∞–∫–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–ª–∞—Å—Å¬†`ClaimsIdentity`. –û–±—ä–µ–∫—Ç¬†`IIdentity`, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ —á–µ—Ä–µ–∑ —Å–ª–µ–¥—É—é—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞:

```c#
public interface IIdentity
{
	// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û–±—ã—á–Ω–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–æ–¥–æ–±–Ω–æ–≥–æ –∏–º–µ–Ω–∏
	// –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–≥–∏–Ω, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ö–æ–¥–∏—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
	string? Name { get; }
	
	// –¢–∏–ø –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ —Å—Ç—Ä–æ–∫–æ–≤–æ–º –≤–∏–¥–µ
	string? AuthenticationType { get; }
	
	// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç¬†`true`, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
	bool IsAuthenticated { get; }
}
```

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ `ClaimsIdentity` –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å —Ä—è–¥ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤, –Ω–æ, –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, –∫–∞–∫ –º–∏–Ω–∏–º—É–º, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–∏–ø –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä. –¢–∏–ø –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—É—é —Å—Ç—Ä–æ–∫—É, –∫–æ—Ç–æ—Ä–∞—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –æ–±—Ä–∞–∑–æ–º —Å–ø–æ—Å–æ–± –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

```c#
var identity = new ClaimsIdentity("Cookies");
var principal = new ClaimsPrincipal(identity);

await context.SignInAsync(claimsPrincipal);
await context.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme);
```

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–Ω–æ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `context.SignInAsync`.
–ê —Ä–∞–∑–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ `context.SignOutAsync` —É –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

```c#
builder.Services.AddAuthentication(
	CookieAuthenticationDefaults.AuthenticationScheme).AddCookie();
 
var app = builder.Build();
 
app.UseAuthentication();
 
app.MapGet("/login", async (HttpContext context) =>
{
    var claimsIdentity = new ClaimsIdentity("Undefined");
    var claimsPrincipal = new ClaimsPrincipal(claimsIdentity);
    
    // —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∫—É–∫–∏
    await context.SignInAsync(claimsPrincipal);
    return Results.Redirect("/");
});
 
app.MapGet("/logout", async (HttpContext context) =>
{
    await context.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme);
    return "–î–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã";
});

app.Map("/", (HttpContext context) =>
{
    var user = context.User.Identity;
    if (user is not null && user.IsAuthenticated)
    {
        return $"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω";
    }
    else
    {
        return "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω";
    }
});
```

–¢–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ —Å–≤–æ–π—Å—Ç–≤–æ¬†`context.User`. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏ —ç—Ç–æ —Ç–æ—Ç —Å–∞–º—ã–π –æ–±—ä–µ–∫—Ç `ClaimsPrincipal`, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∑–∞–ø–∏—Å—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ `context.SignInAsync()`. –ò –∫–æ–≥–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∑–∞–ø—Ä–æ—Å, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `AspNetCore` –¥–µ—à–∏—Ñ—Ä—É–µ—Ç –∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞ –∏ —Å–æ–∑–¥–∞–µ—Ç –ø–æ –Ω–∏–º –æ–±—ä–µ–∫—Ç `ClaimsPrincipal`, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `context.User`.

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ `Cookies`, —Ç–æ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –±—É–¥—É—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å—Å—è –∏–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∫—É–∫. –ï—Å–ª–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è `jwt` —Ç–æ–∫–µ–Ω—ã, —Ç–æ –¥–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞. –ü—Ä–∏—á–µ–º –¥–∞–∂–µ –µ—Å–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∫—É–∫–∏ –∏–ª–∏ —Ç–æ–∫–µ–Ω–∞ –≤ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ—Ç, —Ç–æ –æ–±—ä–µ–∫—Ç `ClaimsPrincipal` –≤—Å–µ —Ä–∞–≤–Ω–æ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π `AspNetCore`.

–ü–æ—Å–∫–æ–ª—å–∫—É –æ–±—ä–µ–∫—Ç `HttpContext` –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –ª—é–±–æ–π —Ç–æ—á–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ç–æ –º—ã –º–æ–∂–µ–º —á–µ—Ä–µ–∑ —ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ. –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –Ω–∞–º –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Å–≤–æ–π—Å—Ç–≤–æ `User`, –∞ –Ω–µ –≤–µ—Å—å –æ–±—ä–µ–∫—Ç `HttpContext`, —Ç–æ –º—ã –º–æ–∂–µ–º —Ç–∞–∫–∂–µ —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø–æ–ª—É—á–∏—Ç—å —Å–µ—Ä–≤–∏—Å `ClaimsPrincipal`.

```c#
app.Map("/", (ClaimsPrincipal claimsPrincipal) =>
{
    var user = claimsPrincipal.Identity;
    if (user is not null && user.IsAuthenticated) 
        return "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω";
    else return "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω";
});
```

---

–†–∞–Ω–µ–µ –±—ã–ª —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω –æ–±—ä–µ–∫—Ç¬†`context.User`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å `ClaimsPrincipal` –∏ –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–≤–æ–π—Å—Ç–≤–µ¬†`Identity`¬†–≤ –≤–∏–¥–µ¬†`ClaimsIdentity`. –ù–æ —á—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–∞–º–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è? –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –æ–±—ä–µ–∫—Ç—ã `Claim`.

–û–±—ä–µ–∫—Ç—ã¬†`Claim`¬†–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –Ω–µ–∫–æ—Ç–æ—Ä—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, –∫–æ—Ç–æ—Ä—É—é –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç, –≥–æ—Ä–æ–¥, —Å—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è, –ª—é–±–∏–º–∞—è –º—É–∑—ã–∫–∞–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∞ –∏ –ø—Ä–æ—á–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏. –ò –≤—Å–µ —ç—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–æ–≥—É—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã `Claim`. –ò –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —ç—Ç–∏—Ö `Claim` –º—ã –º–æ–∂–µ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–æ—Å—Ç—É–ø –∫ —Ç–æ–º—É –∏–ª–∏ –∏–Ω–æ–º—É —Ä–µ—Å—É—Ä—Å—É. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, `Claims` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –±–æ–ª–µ–µ –æ–±—â–∏–π –º–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–∂–µ–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ª–æ–≥–∏–Ω—ã –∏–ª–∏ —Ä–æ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –ª–∏—à—å –∫ –æ–¥–Ω–æ–º—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –ø—Ä–∏–∑–Ω–∞–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç `Claim` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å¬†`Claim`¬†–∏–∑ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω¬†`System.Security.Claims`, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞:

```C#
public class Claim  
{
	// –ù–∞–∑–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ —Å–ª—É–∂–±—ã, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–¥–∞–ª–∞ –¥–∞–Ω–Ω—ã–π claim 
	public string Issuer { get; }
	
	// –ò—Å—Ö–æ–¥–Ω—ã–π –∏–∑–¥–∞—Ç–µ–ª—å claim, –µ—Å–ª–∏ –æ–Ω –±—ã–ª –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –∏–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω 
	// –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ —Ñ–µ–¥–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏)
	public string OriginalIssuer { get; }
	
	// –û–±—ä–µ–∫—Ç ClaimsIdentity, –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –¥–∞–Ω–Ω—ã–π claim
	// —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ –µ–≥–æ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏
	public ClaimsIdentity? Subject { get; }
	
	// –¢–∏–ø –¥–∞–Ω–Ω–æ–≥–æ claim, –Ω–∞–ø—Ä–∏–º–µ—Ä, "name", "role", "email"
	// –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ claim
	public string Type { get; }
	
	// –û—Å–Ω–æ–≤–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ claim, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–º—è
	// –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ä–æ–ª—å –∏–ª–∏ –∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã
	public string Value { get; }
	
	// –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, "http://www.w3.org/2001/XMLSchema#string" 
	// –û–Ω–æ –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª—é claim –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ.
	public string ValueType { get; }
}
```

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ `Claim` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤, –Ω–æ —á–∞—â–µ
–≤—Å–µ–≥–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è –≤–µ—Ä—Å–∏—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è –¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:

```c#
public Claim(string type, string value)
```

–í –∫–∞—á–µ—Å—Ç–≤–µ –ø–µ—Ä–≤–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ç–∏–ø `Claim` —ç—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä–∞—è, –æ–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ `Claim`. –í –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ç–æ—Ä–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ.
–í –∫–∞—á–µ—Å—Ç–≤–µ —Ç–∏–ø–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã, –∫ –ø—Ä–∏–º–µ—Ä—É¬†`ClaimTypes.Name`, –∫–æ—Ç–æ—Ä–∞—è –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ `http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name` –∏ –∫–æ—Ç–æ—Ä–∞—è –æ–±—ã—á–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–æ, —á—Ç–æ –ø–æ—Ç–æ–º –º—ã —Å–º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ —Å–≤–æ–π—Å—Ç–≤–æ `HttpContext.User.Identity.Name`. –ù–æ –ø—Ä–∏ —ç—Ç–æ–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª—é—á–∞ —Ç–∏–ø–∞ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏, –Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `ClaimTypes` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –∑–∞–ø–∏—Å–∏ —Å–≤–æ–π—Å—Ç–≤ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ `AspNetCore`.

```c#
var usernameClaim = new Claim(ClaimTypes.Name, "Tom");
```

–í—Å–µ –æ–±—ä–µ–∫—Ç—ã `Claim`, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Å–æ–∑–¥–∞–ª–∏ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∑–∞—Ç–µ–º 
–º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –≤ –≤–∏–¥–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—Å–∞ `ClaimsIdentity`:

```c#
var usernameClaim = new Claim(ClaimTypes.Name, "Tom");
var claimsIdentity = new ClaimsIdentity(
	new List<Claim> { usernameClaim }, "Cookies");
```

–û–±—ä–µ–∫—Ç `ClaimsIdentity` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä—è–¥ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ
–ø–æ–∑–≤–æ–ª—è—é—Ç —É–¥–æ–±–Ω–æ –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π —Å —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è–º–∏.

```c#
// 1. –°–æ–∑–¥–∞–µ–º ClaimsIdentity –∏ –¥–æ–±–∞–≤–ª—è–µ–º claims
var identity = new ClaimsIdentity();

// –î–æ–±–∞–≤–ª—è–µ–º –æ–¥–∏–Ω–æ—á–Ω—ã–π claim
identity.AddClaim(new Claim(ClaimTypes.Name, "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤"));

// –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ claims
identity.AddClaims(new List<Claim>
{
	new Claim(ClaimTypes.Email, "ivan@example.com"),
	new Claim(ClaimTypes.Role, "Admin"),
	new Claim(ClaimTypes.Role, "Developer"),
	new Claim("CustomClaim", "CustomValue"),
	new Claim(ClaimTypes.DateOfBirth, "1985-05-15", ClaimValueTypes.Date)
};);

// 2. –°–æ–∑–¥–∞–µ–º ClaimsPrincipal
var principal = new ClaimsPrincipal(identity);

// 3. –†–∞–±–æ—Ç–∞ —Å Claims —á–µ—Ä–µ–∑ ClaimsPrincipal
Console.WriteLine("–í—Å–µ claims —á–µ—Ä–µ–∑ Principal:");
foreach (var claim in principal.Claims)
	Console.WriteLine($"{claim.Type}: {claim.Value}");

// 4. –ü–æ–∏—Å–∫ claims
var roleClaims = principal.FindAll(ClaimTypes.Role);
foreach (var claim in roleClaims)
	Console.WriteLine(claim.Value);

var firstEmail = principal.FindFirst(ClaimTypes.Email);
Console.WriteLine($"\n–ü–µ—Ä–≤—ã–π email: {firstEmail?.Value}");

// 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è claim
bool hasAdminRole = principal.HasClaim(ClaimTypes.Role, "Admin");
Console.WriteLine($"\n–ï—Å—Ç—å –ª–∏ —Ä–æ–ª—å Admin: {hasAdminRole}");

bool hasCustomClaim = principal.HasClaim(c => 
	c.Type == "CustomClaim" && c.Value == "CustomValue");

// 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏
bool isInAdminRole = principal.IsInRole("Admin");
Console.WriteLine($"–ü—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ª–∏ –∫ —Ä–æ–ª–∏ Admin: {isInAdminRole}");

// 7. –†–∞–±–æ—Ç–∞ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Å ClaimsIdentity
Console.WriteLine("\n–†–∞–±–æ—Ç–∞ —Å ClaimsIdentity:");

// –ü–æ–∏—Å–∫ claims –≤ identity
var dobClaim = identity.FindFirst(ClaimTypes.DateOfBirth);
Console.WriteLine($"–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: {dobClaim?.Value}");

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è claim
bool hasDobClaim = identity.HasClaim(c => c.Type == ClaimTypes.DateOfBirth);
Console.WriteLine($"–ï—Å—Ç—å –ª–∏ claim —Å –¥–∞—Ç–æ–π —Ä–æ–∂–¥–µ–Ω–∏—è: {hasDobClaim}");

// –£–¥–∞–ª–µ–Ω–∏–µ claim
var claimToRemove = identity.FindFirst("CustomClaim");
if (claimToRemove != null)
{
	identity.RemoveClaim(claimToRemove);
	Console.WriteLine("CustomClaim –±—ã–ª —É–¥–∞–ª–µ–Ω");
}

// –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å TryRemoveClaim (–≤ .NET Core 3.0+)
var emailClaim = new Claim(ClaimTypes.Email, "ivan@example.com");
bool removed = identity.TryRemoveClaim(emailClaim);
Console.WriteLine($"Email claim –±—ã–ª —É–¥–∞–ª–µ–Ω: {removed}");

// –í—ã–≤–æ–¥ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è claims
Console.WriteLine("\n–û—Å—Ç–∞–≤—à–∏–µ—Å—è claims:");
foreach (var claim in identity.Claims)
	Console.WriteLine($"{claim.Type}: {claim.Value}");
```

–ï—Å–ª–∏ –º—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Ä–µ—à–∏–º –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π `claim` –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π, —Ç–æ
–ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `claim` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–Ω–æ–≤–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç `ClaimsPrincipal`
–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫—É–∫–∏ –∏–ª–∏ `jwt` —Ç–æ–∫–µ–Ω, –≥–¥–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω–∏—Ç—å—Å—è.

```c#
app.MapGet("/addage", async (HttpContext context) =>
{
    if(context.User.Identity is ClaimsIdentity claimsIdentity)
    {
        claimsIdentity.AddClaim(new Claim("age", "37"));
        var claimsPrincipal = new ClaimsPrincipal(claimsIdentity);
        await context.SignInAsync(claimsPrincipal);
    }
    return Results.Redirect("/");
});
```

---

–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ —Ä–æ–ª—è–º –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å–∞–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏, –∫ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. 

–î–ª—è —É–∫–∞–∑–∞–Ω–∏—è —Ä–æ–ª–∏ –∑–¥–µ—Å—å –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–∏–ø `Claim`¬†`ClaimsIdentity.DefaultRoleClaimType`, 
–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —ç—Ç–æ–≥–æ —Ç–∏–ø–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–º—è —Ä–æ–ª–∏. –ü–æ —Å—É—Ç–∏ –±–æ–ª—å—à–µ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–æ–ª–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∏–∫–∞–∫–∏—Ö –¥—Ä—É–≥–∏—Ö —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ.

–ß—Ç–æ–±—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
–æ—Ç —Ä–æ–ª–∏, —Å–≤–æ–π—Å—Ç–≤—É¬†`Roles`¬†–∞—Ç—Ä–∏–±—É—Ç–∞¬†`Authorize`¬†–ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –Ω–∞–±–æ—Ä –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Ä–æ–ª–µ–π:

```c#
app.Map("/admin", [Authorize(Roles = "admin")]() => "Admin Panel");

app.Map("/", [Authorize(Roles = "admin, user")](HttpContext context) =>
{
    var login = context.User.FindFirst(ClaimsIdentity.DefaultNameClaimType);
    var role = context.User.FindFirst(ClaimsIdentity.DefaultRoleClaimType);  
    return $"Name: {login?.Value}\nRole: {role?.Value}";
});
```

---

–ê—Ç—Ä–∏–±—É—Ç `Authorize` –ª–µ–≥–∫–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏, –æ–¥–Ω–∞–∫–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–æ–ª–µ–π –±—ã–≤–∞–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–∑—Ä–∞—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏  –¥—Ä—É–≥–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

–î–ª—è —ç—Ç–æ–≥–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ `Claims`. –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ `Claims`, —Ç–∞–∫ –∫–∞–∫
—Ä–æ–ª—å —ç—Ç–æ —Ç–æ—Ç –∂–µ –æ–±—ä–µ–∫—Ç `Claim`, –∏–º–µ—é—â–∏–π —Ç–∏–ø¬†`ClaimsIdentity.DefaultRoleClaimType`.

–î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ `Claims` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è¬†–ø–æ–ª–∏—Ç–∏–∫–∏ `Policy`. –ü–æ–ª–∏—Ç–∏–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞–±–æ—Ä –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–º –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å—É.

–í—Å–µ –ø—Ä–∏–º–µ–Ω—è–µ–º—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –º–µ—Ç–æ–¥–æ–º `builder.Services.AddAuthorization()`. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ–ª–∏—Ç–∏–∫–∏ —Å –ø–æ–º–æ—â—å—é –æ–±—ä–µ–∫—Ç–∞¬†`AuthorizationOptions`. –ù–∞–ø—Ä–∏–º–µ—Ä:

```c#
builder.Services.AddAuthorization(opts => {
     
    opts.AddPolicy("OnlyForMicrosoft", policy => {
        policy.RequireClaim("company", "Microsoft");
    });
});

app.Map("/", [Authorize(Policy = "OnlyForMicrosoft")](HttpContext context)
	=> return $"{context.User.FindFirst("company")}";);
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–∏—Ç–∏–∫–∞ —Å –∏–º–µ–Ω–µ–º `OnlyForMicrosoft`. –ò –æ–Ω–∞ —Ç—Ä–µ–±—É–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±—ä–µ–∫—Ç–∞ `Claim` —Å —Ç–∏–ø–æ–º `Company`
–∏ –∑–Ω–∞—á–µ–Ω–∏–µ–º `Microsoft`. –ï—Å–ª–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–¥–æ–±–Ω–æ–≥–æ
–æ–±—ä–µ–∫—Ç–∞ `Claim`, —Ç–æ —Ç–∞–∫–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —ç—Ç–æ–π –ø–æ–ª–∏—Ç–∏–∫–µ.

```c#
// RequireRole(roles) - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –æ–¥–Ω—É –∏–∑ —Ä–æ–ª–µ–π.
// RequireUserName(name) - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ª–æ–≥–∏–Ω name.
// RequireAuthenticatedUser() - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω.
// RequireClaim(type) - –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω claim —Å —Ç–∏–ø–æ–º type.
// RequireClaim(type, values) - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å —Ç–∏–ø–æ–º type –∏ –∑–Ω–∞—á–µ–Ω–∏–µ–º. 
// RequireAssertion(handler) - –∑–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —É—Å–ª–æ–≤–∏—é –≤ –¥–µ–ª–µ–≥–∞—Ç–µ.
// AddRequirements(requirement) - –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ.

services.AddAuthorization(options =>
{
	// 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
	// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ [Authorize] –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
	options.DefaultPolicy = new AuthorizationPolicyBuilder()
		.RequireAuthenticatedUser() // –¢—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
		.Build();
		
	// 2. –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
	options.AddPolicy("AdminOnly", policy => 
	{
		policy.RequireAuthenticatedUser()
		  .RequireRole("Administrator"); // –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–ª—å Administrator
	});
	
	// 3. –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
	options.AddPolicy("ContentEditors", policy =>
	{
		policy.RequireAuthenticatedUser()
		  .RequireRole("Editor", "SeniorEditor") // –î–ª—è Editor –∏–ª–∏ SeniorEditor
		  .RequireClaim("Department", "Content"); // –ò claim Department=Content
	});
	
	// 4. –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º
	options.AddPolicy("FinanceAccess", policy =>
	{
		policy.RequireAuthenticatedUser()
		  .RequireClaim("Level", "High", "VeryHigh") // Level=High –∏–ª–∏ VeryHigh
		  .RequireClaim("AccessArea", "Finance"); // –ò AccessArea=Finance
	});
	
	// 5. –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞)
	options.AddPolicy("SystemAccount", policy =>
	{
		policy.RequireUserName("system@example.com"); // –¢–æ–ª—å–∫–æ –¥–ª—è —ç—Ç–æ–≥–æ –ª–æ–≥–∏–Ω–∞
	});
	
	// 6. –ü–æ–ª–∏—Ç–∏–∫–∞ —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π –ª–æ–≥–∏–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
	options.AddPolicy("MinimumExperience", policy =>
	{
		policy.RequireAuthenticatedUser()
			  .RequireAssertion(context =>
			  {
				  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å claim —Å –æ–ø—ã—Ç–æ–º
				  var experienceClaim = context.User.FindFirst("ExperienceYears");
				  if (experienceClaim == null) return false;
				  
				  // –ü–∞—Ä—Å–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ–ø—ã—Ç >= 3 –ª–µ—Ç
				  if (int.TryParse(experienceClaim.Value, out int years))
				  {
					  return years >= 3;
				  }
				  return false;
			  });
	});
	
	
	// 7. –ü–æ–ª–∏—Ç–∏–∫–∞ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ–º
	options.AddPolicy("HasSecurityTraining", policy =>
	{
		policy.RequireAuthenticatedUser()
			  .AddRequirements(new CompletedTrainingRequirement("Security"));
			   // –ö–∞—Å—Ç–æ–º–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ
	});
});

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
services.AddSingleton<IAuthorizationHandler, CompletedTrainingHandler>();
```

---
–û–¥–Ω–∏–º –∏–∑ –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ `AspNetCore` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é `JWT` —Ç–æ–∫–µ–Ω–æ–≤. –¢–æ–∫–µ–Ω `JWT` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤–µ–± —Å—Ç–∞–Ω–¥–∞—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–∞—á–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ `JSON`.

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `JWT` —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ `AspNetCore` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å `Nuget` –ø–∞–∫–µ—Ç `Microsoft.AspNetCore.Authentication.JwtBearer`. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é `NetCLI`.

```c#
builder.Services.AddAuthorization();
builder.Services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)
.AddJwtBearer(options =>
{
	options.TokenValidationParameters = new TokenValidationParameters
	{
		// —É–∫–∞–∑—ã–≤–∞–µ—Ç, –±—É–¥–µ—Ç –ª–∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏–∑–¥–∞—Ç–µ–ª—å –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–∞
		ValidateIssuer = true,
		// —Å—Ç—Ä–æ–∫–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∞—è –∏–∑–¥–∞—Ç–µ–ª—è
		ValidIssuer = AuthOptions.ISSUER,
		// –±—É–¥–µ—Ç –ª–∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å —Ç–æ–∫–µ–Ω–∞
		ValidateAudience = true,
		// —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è —Ç–æ–∫–µ–Ω–∞
		ValidAudience = AuthOptions.AUDIENCE,
		// –±—É–¥–µ—Ç –ª–∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤—Ä–µ–º—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è
		ValidateLifetime = true,
		// —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–ª—é—á–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
		IssuerSigningKey = AuthOptions.GetSymmetricSecurityKey(),
		// –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
		ValidateIssuerSigningKey = true,
	 };
});
```

```c#
app.UseAuthentication();
app.UseAuthorization();
 
app.Map("/login/{username}", (string username) => 
{
    var claims = new List<Claim> { new Claim(ClaimTypes.Name, username) };
    var jwt = new JwtSecurityToken(
            issuer: AuthOptions.ISSUER,
            audience: AuthOptions.AUDIENCE,
            claims: claims,
            expires: DateTime.UtcNow.Add(TimeSpan.FromMinutes(2)),
            signingCredentials: 
	            new SigningCredentials(
		            AuthOptions.GetSymmetricSecurityKey(), 
		            SecurityAlgorithms.HmacSha256));
            
    return new JwtSecurityTokenHandler().WriteToken(jwt);
});
 
app.Map("/data", [Authorize] () => new { message= "Hello World!" });
```

```c#
public class AuthOptions
{
    public const string ISSUER = "MyAuthServer"; // –∏–∑–¥–∞—Ç–µ–ª—å —Ç–æ–∫–µ–Ω–∞
    public const string AUDIENCE = "MyAuthClient"; // –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å —Ç–æ–∫–µ–Ω–∞
    const string KEY = "mysupersecret_secretsecretsecretkey!123";   // –∫–ª—é—á
    public static SymmetricSecurityKey GetSymmetricSecurityKey() => 
        new SymmetricSecurityKey(Encoding.UTF8.GetBytes(KEY));
}
```

–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞¬†`ISSUER`¬†–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–∑–¥–∞—Ç–µ–ª—è —Ç–æ–∫–µ–Ω–∞. –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ª—é–±–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ.
–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞¬†`AUDIENCE`¬†–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è —Ç–æ–∫–µ–Ω–∞, –æ–ø—è—Ç—å –∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–∞—è —Å—Ç—Ä–æ–∫–∞, –æ–±—ã—á–Ω–æ —ç—Ç–æ —Å–∞–π—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–∫–µ–Ω. –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞¬†`KEY`¬†—Ö—Ä–∞–Ω–∏—Ç –∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–∞. –°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –º–æ–≥—É—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ä–∞–∑–º–µ—Ä –∫–ª—é—á–∞. –¢–∞–∫, –≤ –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º¬†`SecurityAlgorithms.HmacSha256`, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º –∫–ª—é—á `32` –±–∞–π—Ç–∞.

–ò –º–µ—Ç–æ–¥¬†`GetSymmetricSecurityKey()`¬†–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–ª—é—á –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–∞. –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–∞ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞¬†SecurityKey. –í –∫–∞—á–µ—Å—Ç–≤–µ —Ç–∞–∫–æ–≥–æ –∑–¥–µ—Å—å –≤—ã—Å—Ç—É–ø–∞–µ—Ç –æ–±—ä–µ–∫—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞¬†SymmetricSecurityKey, –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–æ—Ç–æ—Ä–æ–≥–æ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –º–∞—Å—Å–∏–≤ –±–∞–π—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –ø–æ —Å–µ–∫—Ä–µ—Ç–Ω–æ–º—É –∫–ª—é—á—É.

–ß—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω–∞, –≤ –º–µ—Ç–æ–¥¬†`AddAuthentication`¬†–ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ `JwtBearerDefaults.AuthenticationScheme`.

---

–û–¥–Ω–∏–º –∏–∑ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ `AspNetCore` —è–≤–ª—è–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º–∞ `Cookie`. –ü—Ä–∏ —ç—Ç–æ–º –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–¥–∞–µ—Ç—Å—è `Cookie` —Å —Ç–æ–∫–µ–Ω–æ–º, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –∫ —Å–µ—Ä–≤–µ—Ä—É. `Cookie` –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å: –∑–∞–¥–∞–≤–∞—Ç—å —Å—Ä–æ–∫ –∂–∏–∑–Ω–∏, –ø–æ–ª–∏—Ç–∏–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∏–º—è –∏ –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ —É–¥–æ–±–µ–Ω –¥–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –≥–¥–µ —Å–µ—Ä–≤–µ—Ä –∏ –∫–ª–∏–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞—é—Ç –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞. –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ `Cookie` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Å—Ö–µ–º—É –≤ –º–µ—Ç–æ–¥–µ `AddAuthentication` –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ `AddCookie`. 

–í —Å–ª—É—á–∞–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ `Cookie` –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. 
–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –≤ `Cookie` –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∏ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –≠—Ç–æ—Ç —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–æ–º –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ.

```c#
builder.Services.AddAuthentication(
	CookieAuthenticationDefaults.AuthenticationScheme)
    .AddCookie(options =>
{
	// –ü—É—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –Ω–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
	options.LoginPath = "/login"; 
	
	// –ü—É—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è,
	// –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å—É
	options.AccessDeniedPath = "/accessdenied"; 
	
	// –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ cookie (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –±—Ä–∞—É–∑–µ—Ä–∞)
	options.ExpireTimeSpan = TimeSpan.FromDays(30); 
	
	// –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ cookie –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ
	options.SlidingExpiration = true; 
	
	// –ò–º—è cookie (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ".AspNetCore.Cookies")
	options.Cookie.Name = "auth_cookie"; 
	
	// –î–æ–º–µ–Ω, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –±—É–¥–µ—Ç –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å cookie 
	// options.Cookie.Domain = "example.com"; 
	// –ü—É—Ç—å, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ cookie –±—É–¥–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "/")
	options.Cookie.Path = "/"; 
	
	// –§–ª–∞–≥, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π, —á—Ç–æ cookie –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ HTTP (–±–µ–∑ JS)
	options.Cookie.HttpOnly = true; 
	
	// –ü–æ–ª–∏—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ cookie (SameSiteMode.Strict/Lax/None)
	options.Cookie.SameSite = SameSiteMode.Strict; 
	
	// –¢—Ä–µ–±—É–µ—Ç HTTPS –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ cookie (–≤ Production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è true)
	options.Cookie.SecurePolicy = CookieSecurePolicy.Always; 
	
	// –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –ª–æ–≥–∏–Ω
	options.Events.OnRedirectToLogin = context =>
	{
		// –ö–∞—Å—Ç–æ–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è API –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 401 –≤–º–µ—Å—Ç–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞)
		return Task.CompletedTask;
	};
	
	// –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ –æ—Ç–∫–∞–∑–∞ –≤ –¥–æ—Å—Ç—É–ø–µ
	options.Events.OnRedirectToAccessDenied = context =>
	{
		// –ö–∞—Å—Ç–æ–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è API –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 403 –≤–º–µ—Å—Ç–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞)
		return Task.CompletedTask;
	};
});
```

```c#
app.UseAuthentication();
app.UseAuthorization();

app.MapPost("/login", async (HttpContext context, string username) =>
{
    var claims = new List<Claim> { new Claim(ClaimTypes.Name, username)};
    var claimsIdentity = new ClaimsIdentity(claims, 
	    CookieAuthenticationDefaults.AuthenticationScheme);
    var authProperties = new AuthenticationProperties
    {
        IsPersistent = true, // cookie —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
        ExpiresUtc = DateTimeOffset.UtcNow.AddDays(30)
    };

    await context.SignInAsync(
        CookieAuthenticationDefaults.AuthenticationScheme,
        new ClaimsPrincipal(claimsIdentity),
        authProperties);

    return Results.Ok(new { message = "–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥" });
});
```

[[AspNetCore/üü°Base|üü°Base]]
