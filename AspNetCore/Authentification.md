–í–∞–∂–Ω–æ–µ –º–µ—Å—Ç–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–∞–Ω–∏–º–∞–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è¬†–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –∏–º–µ–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∞–≤–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º—É —Ä–µ—Å—É—Ä—Å—É. –°–∏—Å—Ç–µ–º–∞
`AspNetCore` –∏–º–µ–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –∫–æ–Ω–≤–µ–π–µ—Ä–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç–≤–µ—á–∞–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `middleware` ¬†`AuthenticationMiddleware`. –î–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è —ç—Ç–æ–≥–æ `middleware` –≤ –∫–æ–Ω–≤–µ–π–µ—Ä –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã¬†`UseAuthentication()`.

–°–ª–µ–¥—É–µ—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –º–µ—Ç–æ–¥¬†`UseAuthentication()`¬†–¥–æ–ª–∂–µ–Ω –≤—Å—Ç—Ä–∞–∏–≤–∞—Ç—å—Å—è –≤ –∫–æ–Ω–≤–µ–π–µ—Ä –¥–æ –ª—é–±—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ `middleware`, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —ç—Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ä–≤–∏—Å—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏¬†`IAuthenticationService`, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑¬†`AddAuthentication()`.

```c#
var builder = WebApplication.CreateBuilder();
builder.Services.AddAuthentication("Bearer") 
    .AddJwtBearer();
 
var app = builder.Build();
app.UseAuthentication();
```

–í –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤—Ç–æ—Ä–∞—è –≤–µ—Ä—Å–∏—è –º–µ—Ç–æ–¥–∞¬†`AddAuthentication()`¬†–ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—Ö–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏. –¢—Ä–µ—Ç—å—è –≤–µ—Ä—Å–∏—è –º–µ—Ç–æ–¥–∞ `AddAuthentication` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç
–¥–µ–ª–µ–≥–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–ø—Ü–∏–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–±—ä–µ–∫—Ç `AuthenticationOptions`.

–ö–∞–∫—É—é –±—ã –º—ã –≤–µ—Ä—Å–∏—é –º–µ—Ç–æ–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏, –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ö–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫ `Cookies` –∏ `Bearer`.
–û–¥–Ω–∞ —Ö—Ä–∞–Ω–∏—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤ –∫—É–∫–∞—Ö, –∞ –≤—Ç–æ—Ä–∞—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –µ–≥–æ –≤ `jwt` —Ç–æ–∫–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.    

–°—Ö–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏¬†–ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏¬†—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∏—Å—Ö–æ–¥—è –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Å—Ö–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é –∫—É–∫–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Å—Ö–µ–º–∞ `Cookies`.
–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ `Authentication.Cookies.CookieAuthenticationHandler`, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –≤ –∑–∞–ø—Ä–æ—Å–µ `cookie` –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.

–ê –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ö–µ–º–∞ `Bearer`, —Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è `jwt` —Ç–æ–∫–µ–Ω, –∞
–≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –∫–ª–∞—Å—Å `Authentication.JwtBearer.JwtBearerHandler`. –°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é `jwt` —Ç–æ–∫–µ–Ω–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç —á–µ—Ä–µ–∑ `Nuget` —Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –ø–∞–∫–µ—Ç¬†`Microsoft.AspNetCore.Authentication.JwtBearer`.

–ü—Ä–∏ —á–µ–º –≤ `AspNetCore` –º—ã –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ —Å—Ö–µ–º–∞–º–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ 
–º–æ–∂–µ–º —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏ –ø–æ–¥ –Ω–∏—Ö —Å–≤–æ–∏—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
–ö—Ä–æ–º–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞. –î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:

```c#
builder.Services.AddAuthentication("Bearer").AddJwtBearer();
builder.Services.AddAuthentication("Cookies").AddCookie();
```

–û–±–∞ –º–µ—Ç–æ–¥–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–∞–∫ –º–µ—Ç–æ–¥—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–ª—è `AuthenticationBuilder`, 
–∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤¬†`AddAuthentication()`.

---

–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º–µ,
–∫ –∫–∞–∫–∏–º —Ä–µ—Å—É—Ä—Å–∞–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–Ω –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ –¥–æ—Å—Ç—É–ø–∞ –∏ –ø—Ä–∏ –∫–∞–∫–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö.

–•–æ—Ç—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –ø—Ä–æ—Ü–µ—Å—Å, —Ç–µ–º –Ω–µ –º–µ–Ω–µ–µ 
–¥–ª—è –Ω–µ–µ —Ç–∞–∫–∂–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–∞–∫–∂–µ –ø—Ä–∏–º–µ–Ω—è–ª–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.

–î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `AuthorizationMiddleware`. –î–ª—è —ç—Ç–æ–≥–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è¬†`UseAuthorization()`.
–¢–∞–∫–∂–µ –Ω—É–∂–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é¬†`AddAuthorization()`.

–í—Ç–æ—Ä–∞—è –≤–µ—Ä—Å–∏—è –º–µ—Ç–æ–¥–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–µ–ª–µ–≥–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å –ø–æ–º–æ—â—å—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ
–æ–±—ä–µ–∫—Ç–∞ `AuthorizationOptions` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é. 

–ö–ª—é—á–µ–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ `AspNetCore` —è–≤–ª—è–µ—Ç—Å—è –∞—Ç—Ä–∏–±—É—Ç¬†`AuthorizeAttribute` , –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å–∞–º.

```c#
var builder = WebApplication.CreateBuilder();
 
builder.Services.AddAuthentication("Bearer").AddJwtBearer();    
builder.Services.AddAuthorization();           
 
var app = builder.Build();
 
app.UseAuthentication();
app.UseAuthorization();
 
app.Map("/hello", [Authorize]() => "Hello World!");
app.Map("/", () => "Home Page");
 
app.Run();
```

---
–û–¥–Ω–æ–π –∏–∑ –∑–∞–¥–∞—á –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ `AspNetCore` —è–≤–ª—è–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ –≤–∏–¥–µ —Å–≤–æ–π—Å—Ç–≤–∞¬†`User`¬†–∫–ª–∞—Å—Å–∞ `HttpContext`.

```c#
public abstract System.Security.Claims.ClaimsPrincipal User { get; set; }
```

–î–∞–Ω–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å¬†`ClaimsPrincipal`. –ù–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Å–≤–æ–π—Å—Ç–≤–µ¬†`Identity`¬†–∫–ª–∞—Å—Å–∞ `ClaimPrincipal`.

```c#
public virtual System.Security.Principal.IIdentity? Identity { get; }
```

–≠—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å. –ù–æ —Ç–∞–∫ –∫–∞–∫ —Å  –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –º–æ–∂–µ—Ç
–±—ã—Ç—å —Å–≤—è–∑–∞–Ω –Ω–∞–±–æ—Ä –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–µ–π, —Ç–æ —Ç–∞–∫–∂–µ –≤ –∫–ª–∞—Å—Å–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ¬†`Identities`.

```c#
public virtual IEnumerable<ClaimsIdentity> Identities { get; }
```

–°–≤–æ–π—Å—Ç–≤–æ `Identity` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å¬†`IIdentity`, –∏, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ç–∞–∫–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–ª–∞—Å—Å¬†`ClaimsIdentity`. –û–±—ä–µ–∫—Ç¬†`IIdentity`, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ —á–µ—Ä–µ–∑ —Å–ª–µ–¥—É—é—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞:

```c#
public interface IIdentity
{
	// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û–±—ã—á–Ω–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–æ–¥–æ–±–Ω–æ–≥–æ –∏–º–µ–Ω–∏
	// –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–≥–∏–Ω, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ö–æ–¥–∏—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
	string? Name { get; }
	
	// –¢–∏–ø –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ —Å—Ç—Ä–æ–∫–æ–≤–æ–º –≤–∏–¥–µ
	string? AuthenticationType { get; }
	
	// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç¬†`true`, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω
	bool IsAuthenticated { get; }
}
```

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ `ClaimsIdentity` –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å —Ä—è–¥ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤, –Ω–æ, –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, –∫–∞–∫ –º–∏–Ω–∏–º—É–º, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–∏–ø –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä. –¢–∏–ø –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—É—é —Å—Ç—Ä–æ–∫—É, –∫–æ—Ç–æ—Ä–∞—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –æ–±—Ä–∞–∑–æ–º —Å–ø–æ—Å–æ–± –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

```c#
var identity = new ClaimsIdentity("Cookies");
var principal = new ClaimsPrincipal(identity);

await context.SignInAsync(claimsPrincipal);
await context.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme);
```

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–Ω–æ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `context.SignInAsync`.
–ê —Ä–∞–∑–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ `context.SignOutAsync` —É –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.

```c#
builder.Services.AddAuthentication(
	CookieAuthenticationDefaults.AuthenticationScheme).AddCookie();
 
var app = builder.Build();
 
app.UseAuthentication();
 
app.MapGet("/login", async (HttpContext context) =>
{
    var claimsIdentity = new ClaimsIdentity("Undefined");
    var claimsPrincipal = new ClaimsPrincipal(claimsIdentity);
    
    // —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∫—É–∫–∏
    await context.SignInAsync(claimsPrincipal);
    return Results.Redirect("/");
});
 
app.MapGet("/logout", async (HttpContext context) =>
{
    await context.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme);
    return "–î–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã";
});

app.Map("/", (HttpContext context) =>
{
    var user = context.User.Identity;
    if (user is not null && user.IsAuthenticated)
    {
        return $"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω";
    }
    else
    {
        return "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω";
    }
});
```

–¢–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å —á–µ—Ä–µ–∑ —Å–≤–æ–π—Å—Ç–≤–æ¬†`context.User`. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏ —ç—Ç–æ —Ç–æ—Ç —Å–∞–º—ã–π –æ–±—ä–µ–∫—Ç `ClaimsPrincipal`, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∑–∞–ø–∏—Å—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ `context.SignInAsync()`. –ò –∫–æ–≥–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∑–∞–ø—Ä–æ—Å, –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `AspNetCore` –¥–µ—à–∏—Ñ—Ä—É–µ—Ç –∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞ –∏ —Å–æ–∑–¥–∞–µ—Ç –ø–æ –Ω–∏–º –æ–±—ä–µ–∫—Ç `ClaimsPrincipal`, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `context.User`.

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ `Cookies`, —Ç–æ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –±—É–¥—É—Ç –∏–∑–≤–ª–µ–∫–∞—Ç—å—Å—è –∏–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∫—É–∫. –ï—Å–ª–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è `jwt` —Ç–æ–∫–µ–Ω—ã, —Ç–æ –¥–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞. –ü—Ä–∏—á–µ–º –¥–∞–∂–µ –µ—Å–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∫—É–∫–∏ –∏–ª–∏ —Ç–æ–∫–µ–Ω–∞ –≤ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ—Ç, —Ç–æ –æ–±—ä–µ–∫—Ç `ClaimsPrincipal` –≤—Å–µ —Ä–∞–≤–Ω–æ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π `AspNetCore`.

–ü–æ—Å–∫–æ–ª—å–∫—É –æ–±—ä–µ–∫—Ç `HttpContext` –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –ª—é–±–æ–π —Ç–æ—á–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ç–æ –º—ã –º–æ–∂–µ–º —á–µ—Ä–µ–∑ —ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ. –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –Ω–∞–º –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Å–≤–æ–π—Å—Ç–≤–æ `User`, –∞ –Ω–µ –≤–µ—Å—å –æ–±—ä–µ–∫—Ç `HttpContext`, —Ç–æ –º—ã –º–æ–∂–µ–º —Ç–∞–∫–∂–µ —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø–æ–ª—É—á–∏—Ç—å —Å–µ—Ä–≤–∏—Å `ClaimsPrincipal`.

```c#
app.Map("/", (ClaimsPrincipal claimsPrincipal) =>
{
    var user = claimsPrincipal.Identity;
    if (user is not null && user.IsAuthenticated) 
        return "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω";
    else return "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω";
});
```

---

–†–∞–Ω–µ–µ –±—ã–ª —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω –æ–±—ä–µ–∫—Ç¬†`context.User`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å `ClaimsPrincipal` –∏ –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–≤–æ–π—Å—Ç–≤–µ¬†`Identity`¬†–≤ –≤–∏–¥–µ¬†`ClaimsIdentity`. –ù–æ —á—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–∞–º–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è? –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –æ–±—ä–µ–∫—Ç—ã `Claim`.

–û–±—ä–µ–∫—Ç—ã¬†`Claim`¬†–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –Ω–µ–∫–æ—Ç–æ—Ä—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, –∫–æ—Ç–æ—Ä—É—é –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç, –≥–æ—Ä–æ–¥, —Å—Ç—Ä–∞–Ω–∞ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è, –ª—é–±–∏–º–∞—è –º—É–∑—ã–∫–∞–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∞ –∏ –ø—Ä–æ—á–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏. –ò –≤—Å–µ —ç—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–æ–≥—É—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã `Claim`. –ò –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —ç—Ç–∏—Ö `Claim` –º—ã –º–æ–∂–µ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–æ—Å—Ç—É–ø –∫ —Ç–æ–º—É –∏–ª–∏ –∏–Ω–æ–º—É —Ä–µ—Å—É—Ä—Å—É. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, `Claims` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –±–æ–ª–µ–µ –æ–±—â–∏–π –º–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–∂–µ–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ª–æ–≥–∏–Ω—ã –∏–ª–∏ —Ä–æ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –ª–∏—à—å –∫ –æ–¥–Ω–æ–º—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –ø—Ä–∏–∑–Ω–∞–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç `Claim` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å¬†`Claim`¬†–∏–∑ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω¬†`System.Security.Claims`, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞:

```C#
public class Claim  
{
	// –ù–∞–∑–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ —Å–ª—É–∂–±—ã, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–¥–∞–ª–∞ –¥–∞–Ω–Ω—ã–π claim 
	public string Issuer { get; }
	
	// –ò—Å—Ö–æ–¥–Ω—ã–π –∏–∑–¥–∞—Ç–µ–ª—å claim, –µ—Å–ª–∏ –æ–Ω –±—ã–ª –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –∏–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω 
	// –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ —Ñ–µ–¥–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏)
	public string OriginalIssuer { get; }
	
	// –û–±—ä–µ–∫—Ç ClaimsIdentity, –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –¥–∞–Ω–Ω—ã–π claim
	// —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –∏ –µ–≥–æ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏
	public ClaimsIdentity? Subject { get; }
	
	// –¢–∏–ø –¥–∞–Ω–Ω–æ–≥–æ claim, –Ω–∞–ø—Ä–∏–º–µ—Ä, "name", "role", "email"
	// –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ claim
	public string Type { get; }
	
	// –û—Å–Ω–æ–≤–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ claim, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–º—è
	// –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ä–æ–ª—å –∏–ª–∏ –∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã
	public string Value { get; }
	
	// –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, "http://www.w3.org/2001/XMLSchema#string" 
	// –û–Ω–æ –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª—é claim –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ.
	public string ValueType { get; }
}
```


















---
–û–¥–Ω–∏–º –∏–∑ –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ `AspNetCore` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é `JWT` —Ç–æ–∫–µ–Ω–æ–≤. –¢–æ–∫–µ–Ω `JWT` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤–µ–± —Å—Ç–∞–Ω–¥–∞—Ä—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–∞—á–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ `JSON`.

```c#
builder.Services.AddAuthorization();
builder.Services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)
.AddJwtBearer(options =>
{
	options.TokenValidationParameters = new TokenValidationParameters
	{
		// —É–∫–∞–∑—ã–≤–∞–µ—Ç, –±—É–¥–µ—Ç –ª–∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏–∑–¥–∞—Ç–µ–ª—å –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–∞
		ValidateIssuer = true,
		// —Å—Ç—Ä–æ–∫–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∞—è –∏–∑–¥–∞—Ç–µ–ª—è
		ValidIssuer = AuthOptions.ISSUER,
		// –±—É–¥–µ—Ç –ª–∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å —Ç–æ–∫–µ–Ω–∞
		ValidateAudience = true,
		// —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è —Ç–æ–∫–µ–Ω–∞
		ValidAudience = AuthOptions.AUDIENCE,
		// –±—É–¥–µ—Ç –ª–∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤—Ä–µ–º—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è
		ValidateLifetime = true,
		// —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–ª—é—á–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
		IssuerSigningKey = AuthOptions.GetSymmetricSecurityKey(),
		// –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
		ValidateIssuerSigningKey = true,
	 };
});
```

```c#
app.UseAuthentication();
app.UseAuthorization();
 
app.Map("/login/{username}", (string username) => 
{
    var claims = new List<Claim> {new Claim(ClaimTypes.Name, username) };
    var jwt = new JwtSecurityToken(
            issuer: AuthOptions.ISSUER,
            audience: AuthOptions.AUDIENCE,
            claims: claims,
            expires: DateTime.UtcNow.Add(TimeSpan.FromMinutes(2)),
            signingCredentials: 
	            new SigningCredentials(
		            AuthOptions.GetSymmetricSecurityKey(), 
		            SecurityAlgorithms.HmacSha256));
            
    return new JwtSecurityTokenHandler().WriteToken(jwt);
});
 
app.Map("/data", [Authorize] () => new { message= "Hello World!" });
```

```c#
public class AuthOptions
{
    public const string ISSUER = "MyAuthServer"; // –∏–∑–¥–∞—Ç–µ–ª—å —Ç–æ–∫–µ–Ω–∞
    public const string AUDIENCE = "MyAuthClient"; // –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å —Ç–æ–∫–µ–Ω–∞
    const string KEY = "mysupersecret_secretsecretsecretkey!123";   // –∫–ª—é—á
    public static SymmetricSecurityKey GetSymmetricSecurityKey() => 
        new SymmetricSecurityKey(Encoding.UTF8.GetBytes(KEY));
}
```


































---
---
---

–í–∞–∂–Ω–æ–µ –º–µ—Å—Ç–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–∞–Ω–∏–º–∞–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è¬†–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –∏–º–µ–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∞–≤–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º—É —Ä–µ—Å—É—Ä—Å—É. ASP.NET Core –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –∫–∞–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–∞–∫ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

---

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –∫–æ–Ω–≤–µ–π–µ—Ä–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç middleware¬†`AuthenticationMiddleware`. –î–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è —ç—Ç–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –≤ –∫–æ–Ω–≤–µ–π–µ—Ä –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º–µ—Ç–æ–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è¬†`UseAuthentication()`.

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —ç—Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ä–≤–∏—Å—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, —Å–µ—Ä–≤–∏—Å¬†`IAuthenticationService`, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç¬†`AddAuthentication()`

–í –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤—Ç–æ—Ä–∞—è –≤–µ—Ä—Å–∏—è –º–µ—Ç–æ–¥–∞¬†`AddAuthentication()`¬†–ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—Ö–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏. –¢—Ä–µ—Ç—å—è –≤–µ—Ä—Å–∏—è –º–µ—Ç–æ–¥–∞ `AddAuthentication` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–µ–ª–µ–≥–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–ø—Ü–∏–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ - –æ–±—ä–µ–∫—Ç `AuthenticationOptions`.

–ö–∞–∫—É—é –±—ã –º—ã –≤–µ—Ä—Å–∏—é –º–µ—Ç–æ–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏, –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ö–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –î–≤–µ –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Åc–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Å—Ö–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:` Cookies` –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫—É–∫–æ–≤ –∏ `Bearer` –Ω–∞ –æ—Å–Ω–æ–≤–µ jwt —Ç–æ–∫–µ–Ω–∞.

–°—Ö–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏¬†–ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.¬†–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏¬†—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞.

–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é –∫—É–∫–∏ –±—É–¥–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler`, –∞ –¥–ª—è jwt —Ç–æ–∫–µ–Ω–æ–≤ `Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler`.

–ü—Ä–∏ —á–µ–º –≤ ASP.NET Core –º—ã –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ —Å—Ö–µ–º–∞–º–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –º–æ–∂–µ–º —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ö–µ–º—ã –∏ –ø–æ–¥ –Ω–∏—Ö —Å–≤–æ–∏—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

–ö—Ä–æ–º–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∏ —Å–∞–º–∏ —Å–µ—Ä–≤–∏—Å—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞. –û–Ω–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–∞–∫ –º–µ—Ç–æ–¥—ã —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–ª—è —Ç–∏–ø–∞ `AuthenticationBuilder`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥–æ–º¬†`AddAuthentication()`:

**AddCookie()** - –ø–æ–¥–∫–ª—é—á–∞–µ—Ç –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —Å –ø–æ–º–æ—â—å—é –∫—É–∫–∏.
**AddJwtBearer()** - –ø–æ–¥–∫–ª—é—á–∞–µ—Ç –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —Å –ø–æ–º–æ—â—å—é jwt-—Ç–æ–∫–µ–Ω–æ–≤ (–¥–ª—è —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º Nuget-–ø–∞–∫–µ—Ç¬†Microsoft.AspNetCore.Authentication.JwtBearer)

```c#
var builder = WebApplication.CreateBuilder();
builder.Services.AddAuthentication("Bearer").AddJwtBearer();

var app = builder.Build();
app.UseAuthentication();
```

---

–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º–µ, –∫ –∫–∞–∫–∏–º —Ä–µ—Å—É—Ä—Å–∞–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–Ω –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ –¥–æ—Å—Ç—É–ø–∞ –∏ –ø—Ä–∏ –∫–∞–∫–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö.

–•–æ—Ç—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –ø—Ä–æ—Ü–µ—Å—Å, —Ç–µ–º –Ω–µ –º–µ–Ω–µ–µ –¥–ª—è –Ω–µ–µ —Ç–∞–∫–∂–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–∞–∫–∂–µ –ø—Ä–∏–º–µ–Ω—è–ª–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.

–î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—Å—Ç—Ä–æ–∏—Ç—å¬†`AuthorizationMiddleware`. –î–ª—è —ç—Ç–æ–≥–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è¬†UseAuthorization().

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞¬†`AddAuthorization()`. –í—Ç–æ—Ä–∞—è –≤–µ—Ä—Å–∏—è –º–µ—Ç–æ–¥–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–µ–ª–µ–≥–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å –ø–æ–º–æ—â—å—é `AuthorizationOptions` —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é.

–ö–ª—é—á–µ–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —è–≤–ª—è–µ—Ç—Å—è –∞—Ç—Ä–∏–±—É—Ç¬†`AuthorizeAttribute`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å–∞–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

```c#
using Microsoft.AspNetCore.Authorization;
 
var builder = WebApplication.CreateBuilder();
 
builder.Services.AddAuthentication("Bearer") .AddJwtBearer(); 
builder.Services.AddAuthorization(); 
 
var app = builder.Build();
 
app.UseAuthentication(); 
app.UseAuthorization();  
 
app.Map("/hello", [Authorize]() => "Hello World!");
app.Map("/", () => "Home Page");
 
app.Run();
```

---

–û–¥–Ω–æ–π –∏–∑ –∑–∞–¥–∞—á –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —è–≤–ª—è–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —Å–≤–æ–π—Å—Ç–≤–æ–º¬†`User` –∫–ª–∞—Å—Å–∞ `HttpContext`.
–î–∞–Ω–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–∑ —Å–µ–±—è –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞ `ClaimsPrincipal`.

–ù–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Å–≤–æ–π—Å—Ç–≤–µ `Identity` –∫–ª–∞—Å—Å–∞ `ClaimPrincipal`. –≠—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ù–æ –ø–æ—Å–∫–æ–ª—å–∫—É —Å –æ–¥–Ω–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω –Ω–∞–±–æ—Ä –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–µ–π, —Ç–æ —Ç–∞–∫–∂–µ –≤ –∫–ª–∞—Å—Å–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ —Å–≤–æ–π—Å—Ç–≤–æ `Identities`.

**HttpContext.User** - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ ClaimsPrincipal —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
**ClaimsPrincipal.Identity** - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ ClaimsIdentity —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–°–≤–æ–π—Å—Ç–≤–æ `Identity` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å¬†`IIdentity`, –∏, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ç–∞–∫–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–ª–∞—Å—Å¬†`ClaimsIdentity`. –û–±—ä–µ–∫—Ç¬†`IIdentity`, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ —á–µ—Ä–µ–∑ —Å–ª–µ–¥—É—é—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞:

**AuthenticationType** - —Ç–∏–ø –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ —Å—Ç—Ä–æ–∫–æ–≤–æ–º –≤–∏–¥–µ.
**IsAuthenticated** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç¬†`true`, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω.
**Name** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ –ª–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ `ClaimsIdentity` –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å —Ä—è–¥ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤, –Ω–æ, –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, –∫–∞–∫ –º–∏–Ω–∏–º—É–º, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–∏–ø –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä. –¢–∏–ø –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫—É, –∫–æ—Ç–æ—Ä–∞—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–ø–æ—Å–æ–± –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±—ä–µ–∫—Ç `ClaimsIdentity` –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –≤ `ClaimsPrincipal` –ª–∏–±–æ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä, –ª–∏–±–æ —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥¬†`AddIdetity()`. –ü–æ—Å–ª–µ —á–µ–≥–æ,  `ClaimsPrincipal` –º–æ–∂–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ `context.SignInAsync(claimsPrincipal)`.

–î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –æ–±—ä–µ–∫—Ç—ã `Claim`. –û–±—ä–µ–∫—Ç—ã¬†`Claim`¬†–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –Ω–µ–∫–æ—Ç–æ—Ä—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å –∫–æ—Ç–æ—Ä—É—é –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

–í—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–æ–≥—É—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã `claim`. –ò –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –º—ã –º–æ–∂–µ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–æ—Å—Ç—É–ø –∫ —Ç–æ–º—É –∏–ª–∏ –∏–Ω–æ–º—É —Ä–µ—Å—É—Ä—Å—É. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, `claims` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –±–æ–ª–µ–µ –æ–±—â–∏–π –º–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–∂–µ–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ª–æ–≥–∏–Ω—ã –∏–ª–∏ —Ä–æ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –ª–∏—à—å –∫ –æ–¥–Ω–æ–º—É –ø—Ä–∏–∑–Ω–∞–∫—É.

–ö–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç `claim` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å¬†`Claim`¬†–∏–∑ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω¬†`System.Security.Claims`, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞:

**Issuer** - –∏–∑–¥–∞—Ç–µ–ª—å –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–¥–∞–ª–∞ –¥–∞–Ω–Ω—ã–π claim.
**Subject** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –≤ –≤–∏–¥–µ –æ–±—ä–µ–∫—Ç–∞ ClaimsIdentity.
**Type** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–∏–ø –æ–±—ä–µ–∫—Ç–∞ claim.
**Value** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ claim.

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ `Claim` –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ –µ–≥–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞. –û—Å–Ω–æ–≤–Ω–æ–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–∏–ø –∏ –∑–Ω–∞—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º–æ–≥–æ `Claim`.

–ü–æ—Å–ª–µ —á–µ–≥–æ –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã `Claim`, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∑–∞—Ç–µ–º –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –≤ –≤–∏–¥–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `ClaimsIdentity`.

![[Pasted image 20231231145729.png]]

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ `claim`, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤—Å–µ–º–∏ `ClaimsIdentity` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤ —ç–∫–∑–µ–º–ø–ª—è—Ä–µ `ClaimsPrincipal` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã:

**Claims** - —Å–≤–æ–π—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–±–æ—Ä –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ claim.
**FindAll(type/predicate)** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã claim –ø–æ —É—Å–ª–æ–≤–∏—é –∏–ª–∏ —Ç–∏–ø—É.
**FindFirst(type/predicate)** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π –æ–±—ä–µ–∫—Ç claim –ø–æ —É—Å–ª–æ–≤–∏—é –∏–ª–∏ —Ç–∏–ø—É.
**HasClaim(predicate)** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç true, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç claim –ø–æ —É—Å–ª–æ–≤–∏—é.
**IsInRole(name)** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ true, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ä–æ–ª–∏.

–ë–æ–ª–µ–µ —Ç–æ–Ω–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è–º–∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –º–µ—Ç–æ–¥–∞–º –∏ —Å–≤–æ–π—Å—Ç–≤–∞–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ `ClaimsIdentity` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

**Claims** - —Å–≤–æ–π—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–±–æ—Ä –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ claim.
**FindAll(type/predicate)** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã claim –ø–æ —É—Å–ª–æ–≤–∏—é –∏–ª–∏ —Ç–∏–ø—É.
**FindFirst(type/predicate)** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π –æ–±—ä–µ–∫—Ç claim –ø–æ —É—Å–ª–æ–≤–∏—é –∏–ª–∏ —Ç–∏–ø—É.
**HasClaim(predicate)** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç true, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç claim –ø–æ —É—Å–ª–æ–≤–∏—é.

**AddClaim(claim)** - –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±—ä–µ–∫—Ç claim.
**AddClaims(claims)** - –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–∞–±–æ—Ä –æ–±—ä–µ–∫—Ç–æ–≤ claim.
**RemoveClaim(claim)** - —É–¥–∞–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç claim —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
**TryRemoveClaim(claim)** - true –µ—Å–ª–∏ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –æ–±—ä–µ–∫—Ç claim.

–ï—Å–ª–∏ –º—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Ä–µ—à–∏–º –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π `claim` –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π, —Ç–æ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `claim` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–Ω–æ–≤–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç `ClaimsPrincipal` –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫—É–∫–∏ –∏–ª–∏ jwt-—Ç–æ–∫–µ–Ω, –≥–¥–µ —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è.

```c#
app.MapGet("/login", async (HttpContext context) =>
{
    var claimsIdentity = new ClaimsIdentity("Undefined");
    var claimsPrincipal = new ClaimsPrincipal(claimsIdentity);
    
    await context.SignInAsync(claimsPrincipal);
    return Results.Redirect("/");
});
 
app.MapGet("/logout", async (HttpContext context) =>
{
    await context.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme);
    return "–î–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã";
});

app.Map("/", (HttpContext context) =>
{
    var user = context.User.Identity;
    if (user is not null && user.IsAuthenticated)
    {
        return $"–¢–∏–ø –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: {user.AuthenticationType}";
    }
    else
    {
        return "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω";
    }
});
```

---

–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ —Ä–æ–ª—è–º –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å–∞–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ –∫ –∫–∞–∫–æ–π —Ä–æ–ª–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –¥–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.

–î–ª—è –æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∏—è –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ —Ä–æ–ª—è–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–æ–ª–∏ –≤ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å —Ç–∏–ø–æ–º `ClaimTypes.Role` –∏–ª–∏ `ClaimsIdentity.DefaultRoleClaimType`.

–ü–æ—Å–ª–µ —á–µ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–æ–º —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–Ω–æ —É–±—É–¥–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞—Ç—Ä–∏–±—É—Ç–∞ `Authorize` –ø—Ä–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏–∏ –∫–æ–Ω–µ—á–Ω–æ–π —Ç–æ—á–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. 

–ê—Ç—Ä–∏–±—É—Ç `Authorize` –ª–µ–≥–∫–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏, –æ–¥–Ω–∞–∫–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–æ–ª–µ–π –±—ã–≤–∞–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–∑—Ä–∞—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–î–ª—è —ç—Ç–æ–≥–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ `claims`. –°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ `claims`.

–î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ `claims` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è¬†–ø–æ–ª–∏—Ç–∏–∫–∏ (`policy`). –ü–æ–ª–∏—Ç–∏–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞–±–æ—Ä —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–º –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.

–í—Å–µ –ø—Ä–∏–º–µ–Ω—è–µ–º—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞¬†`builder.Services.AddAuthorization()`. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ–ª–∏—Ç–∏–∫–∏:

```c#
builder.Services.AddAuthorization(opts => 
{
	opts.AddPolicy("OnlyForMicrosoft", policy => 
	{
		policy.RequireClaim("company", "Microsoft");
	});
});
```

–ö–ª—é—á–µ–≤—ã–º –º–µ—Ç–æ–¥–æ–º –∑–¥–µ—Å—å —è–≤–ª—è–µ—Ç—Å—è¬†`AddPolicy()`. –ü–µ—Ä–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –º–µ—Ç–æ–¥–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏, –∞ –≤—Ç–æ—Ä–æ–π - –¥–µ–ª–µ–≥–∞—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–æ–≤  –æ–±—ä–µ–∫—Ç–∞¬†`AuthorizationPolicyBuilder`¬†–ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É –ø–æ —É—Å–ª–æ–≤–∏—è–º:

**RequireRole(roles)** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –æ–¥–Ω—É –∏–∑ —Ä–æ–ª–µ–π.
**RequireUserName(name)** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ª–æ–≥–∏–Ω name.
**RequireAuthenticatedUser()** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω.
**RequireClaim(type)** - –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω claim —Å —Ç–∏–ø–æ–º type.
**RequireClaim(type, values)** -  –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω claim —Å —Ç–∏–ø–æ–º type –∏ –∑–Ω–∞—á–µ–Ω–∏–µ–º. 
**RequireAssertion(handler)** - –∑–∞–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —É—Å–ª–æ–≤–∏—é –≤ –¥–µ–ª–µ–≥–∞—Ç–µ handler.
**AddRequirements(requirement)** - –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ.

–•–æ—Ç—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –ø–æ–ª–∏—Ç–∏–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–ª—É—á–∞–µ–≤ –¥–ª—è –∏—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –Ω–æ –æ–Ω –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.

–ö–ª–∞—Å—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ–ª–∂–µ–Ω —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `IAuthorizationRequirement`. –°–∞–º –∫–ª–∞—Å—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ª–∏–º–∏—Ç—ã, –±–æ–ª—å—à–µ –æ–Ω –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç. –ß—Ç–æ–±—ã –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –Ω–∞–º –Ω–∞–¥ –¥–æ–±–∞–≤–∏—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫.

–ö–ª–∞—Å—Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¥–æ–ª–∂–µ–Ω –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å—Å—è –æ—Ç –∫–ª–∞—Å—Å–∞ `AuthorizationHandler<TReq>`. –í—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –≤ –º–µ—Ç–æ–¥–µ `HandleRequirementAsync()`. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ —Ä–µ—Å—É—Ä—Å—É, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ.

–í –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–µ—Ç–æ–¥¬†`HandleRequirementAsync()`¬†–ø–æ–ª—É—á–∞–µ—Ç –æ–±—ä–µ–∫—Ç –ø—Ä–∏–º–µ–Ω—è–µ–º–æ–≥–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏¬†`AuthorizationHandlerContext`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–ø—Ä–æ—Å–µ. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, —á–µ—Ä–µ–∑ —Å–≤–æ–π—Å—Ç–≤–æ¬†`User`¬†–æ–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç `ClaimPrincipal`, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–ú–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∞ `AuthorizationHandlerContext` –ø–æ–∑–≤–æ–ª—è—é—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π. –¢–∞–∫, –º–µ—Ç–æ–¥ `Succeed(requirement)` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—é requirement. –ò –Ω–∞–æ–±–æ—Ä–æ—Ç, –º–µ—Ç–æ–¥ `Fail()`, –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—é.

**AuthorizationHandlerContext.Succeed()** - –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—é –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.
**AuthorizationHandlerContext.Fail()** - –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—é –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.

[[AspNetCore/üü°Base|üü°Base]]
