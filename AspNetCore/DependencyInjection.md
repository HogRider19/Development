**Dependency injection** - представляет механизм, который позволяет сделать взаимодействующие в приложении объекты слабосвязанными. Такие объекты связаны между собой через абстракции, например, через интерфейсы, что делает всю систему более гибкой, более адаптируемой и расширяемой

**IoC-контейнеры (Inversion of Control)** - такие контейнеры служат своего рода фабриками, которые устанавливают зависимости между абстракциями и конкретными объектами и, как правило, управляют созданием этих объектов

---

**IServiceProvider** - встроенных провайдер ASP для внедрения зависимостей

**WebApplicationBuilder.Services** - представляет объект IServiceCollection для управления сервисами в приложении

**ServiceDescriptor** - объект которым представлен каждый сервис в Sevices

**HttpContext.RequestServices** - получение ServiceProvider из context

---

**Services.AddServName() -** подключение стандартного сервиса **Services.AddTransient()()** - подключение сервиса **Services.AddScoped()()** - подключение сервиса **Services.AddSingleton()()** - подключение сервиса

---

**Services.GetService()** - получение сервиса или null **Services.GetRequiredService()** - получение сервиса или exc

---

## Свойства ServiceDescriptor:

1. **ServiceType** - тип сервиса
2. **ImplementationType** - тип реализации сервиса
3. **Lifetime** - жизненный цикл сервиса

## Сервисы можно получить:

1. Через свойство Services объекта WebApplication (service locator)
2. Через свойство RequestServices контекста запроса HttpContext в компонентах middleware (service locator)
3. Через конструктор класса
4. Через параметр метода Invoke компонента middleware
5. Через свойство Services объекта WebApplicationBuilder

## Жизненный цикл зависимостей:

1. **Transient** - при каждом обращении к сервису создается новый объект сервиса. В течение одного запроса может быть несколько обращений к сервису, соответственно при каждом обращении будет создаваться новый объект. Подобная модель жизненного цикла наиболее подходит для легковесных сервисов, которые не хранят данных о состоянии
2. **Scoped** - для каждого запроса создается свой объект сервиса. То есть если в течение одного запроса есть несколько обращений к одному сервису, то при всех этих обращениях будет использоваться один и тот же объект сервиса.
3. **Singleton** - объект сервиса создается при первом обращении к нему, все последующие запросы используют один и тот же ранее созданный объект сервиса