Технология `SSH (Secure SHell)` представляет из себя сетевой протокол прикладного уровня, предназначенный для безопасного удаленного доступа к `UNIX` системам. 

Эта служба была создана в качестве замены не зашифрованному `Telnet` и использует криптографические техники, чтобы обеспечить, защищённость сообщений клиента.

Данный протокол эффективен тем, что шифрует всю передаваемую информацию по сети. По умолчанию, используется протокол использует соединение на `22` порту.

В основном он нужен для удаленного управления данными пользователя на сервере, запуска служебных команд, работы в консольном режиме с базами данных.

```sh
ssh <user_name>@<host> -p <port>
```

Сервер `SSH` устанавливается на операционной системе и принимает входящие подключения от клиентских машин, проверяя соединение одним из способов:
По `IP` адресу клиента (Не безопасно из-за риска подмены); По публичному ключу клиента и имени пользователя; По паролю клиента, который передается на сервер в зашифрованном виде. Является одним из наиболее распространенных вариантов.

| №   | Операционная система | SSH-сервера                          |
| --- | -------------------- | ------------------------------------ |
| 1   | BSD                  | OpenSSH                              |
| 2   | Linux                | openssh-server, dropbear, lsh-server |
| 3   | Windows              | freeSSHd, copssh, WinSSHD, OpenSSH   |
Клиенты `SSH` используется для входа на удаленный сервер и выполнения команд. Через клиент выполняется управление удаленным компьютером с сервером.

| №   | Операционная система | SSH-клиент                          |
| --- | -------------------- | ----------------------------------- |
| 1   | BSD/Linux            | openssh-client, putty, ssh, Vinagre |
| 2   | Windows              | PuTTY, SecureCRT, ShellGuard        |
| 3   | Android              | connectBot                          |

---

Подключение `SSH` может авторизоваться по ключу из открытой и закрытой частей. 
На узле клиента создаются и хранятся оба ключа, а на узел сервера передается только копия публичного ключа, что позволяет подключаться к узлу сервера с узла клиента.

Публичный `(id_rsa.pub)` и приватный `(id_rsa)` ключи хранятся в домашней директории пользователя в директории `.ssh`. А на сервере только публичный.

Публичный ключ используется для шифрования данных при обращении к удаленному узлу. Проще говоря, это символы для шифрования информации. Он доступен всем. Приватный ключ представляет собой ключ к данным. Он расшифровывает сами сообщения. Хранится он на устройстве, которое будет подключаться к серверу.

Для создания `SSH` сессии клиент подключается на определенный `TCP` порт сервера, после согласования версии протокола, генерируется симметричный ключ для двухстороннего шифрования во время сессии, затем клиент отправляет серверу свой публичный ключ, если у сервера он есть в списке публичных ключей, то сервер генерирует случайную последовательность, шифрует ее открытым ключом пользователя и отправляет клиенту, клиент расшифровываете сообщение закрытым ключом и отправляете полученные данные серверу. В случае совпадения присланной последовательности с первоначальной аутентификация признается успешной.

![[{A80B2D69-0833-4F1A-933E-91F759A74A00}.png]]
В `Linux` для создания `SSH` ключей используется команда `ssh-keygen`. Далее приведены наиболее популярные параметры для этой команды и их описание.

```sh
ssh-keygen -C <Text> //Задает комментарий ключа
ssh-keygen -t <Type> //Задает тип шифрования ключа
ssh-keygen -v        //Подробный вывод при генерации
ssh-keygen -p        //Изменение секретной фразы                            
```

Для отправки ключа на сервер можно воспользоваться утилитой `ssh-copy-id`.  Этот способ требует авторизацию на сервере и поддержку самой утилиты `ssh-copy-id`. Открытый ключ отправляется на сервер и размещается в файле `authorized_keys`.

```sh
ssh-copy-id username@remote_host -p <port>
```

По умолчанию открытый ключ хранится в файле `~/.ssh/id_rsa.pub`
По умолчанию закрытый ключ хранится в файле `~/.ssh/id_rsa`
Файл с разрешенными открытыми ключами `/.ssh/authorized_keys`
