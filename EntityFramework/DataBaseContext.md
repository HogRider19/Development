**DbContext** - базовый класс для взаимодействия с базой данных

Контекст не является потокобезопасным, поэтому его не следует совместно использовать в нескольких потоках, работающих с ним

Если исключение приводит к тому, что контекст будет находиться в невосстановленном состоянии, все приложение может завершить работу.

Вероятность возникновения проблем с параллелизмом возрастает по мере увеличения разрыва между временем запроса и обновления данных

---

**DbSet\<T>** - представляет набор объектов, хранящихся в базе данных  
**DbContextOptionsBuilder** - класс для конфигурации подключения

**modelBuilder.ApplyConfiguration()** - применяет конфигурацию  
**IEntityTypeConfiguration\<User>** - интерфейс для конфигурации модели, заставляет реализовывать методы Configure(modelBuider)

Контекст базы данных может конфигурироваться только с помощью метода OnConfiguring или дополнительно с использованием DbContextOptions, который передается в конструктор класса

---

**OnConfiguring(options)** - виртуальный метод для настройки подключения  
**OnModelCreating(modelBuilder**) - виртуальный метод для настройки моделей, вызывается каждый раз при настройке моделей  
**ConfigureConventions(modelBuilder)** - виртуальный метод для настройки соглашений. Этот метод вызывается перед OnModelCreating

---

## Методы DbContext:

1. **Add(Object)** - Начинает отслеживание сущности, которые еще не отслеживаются, в Added состоянии таким образом, что они будут вставлены в базу данных при SaveChanges() вызове .
    
2. **Attach(Object)** - Начинает отслеживание заданной сущности и записей, доступных из данной сущности, используя Unchanged
    
3. **Update(Object)** - Начинает отслеживание заданной сущности и записей, указывает на обновление записи в БД
    
4. **Remove(Object)** - Начинает отслеживание заданной сущности Deleted в состоянии таким образом, что она будет удалена при SaveChanges()
    
5. **Entry(Object)** - Возвращает объект EntityEntry для заданной сущности. Запись предоставляет доступ к сведениям об отслеживании изменений и операциям для сущности.
    
6. **Find\<TEntity>(Object[])** - Обнаруживает сущность с указанными значениями первичного ключа или возвращает null.
    
7. **SaveChanges()** - Сохраняет все изменения контекста.
    

## Свойства DbContext:

1. **ChangeTracker** - Предоставляет доступ к сведениям и операциям для экземпляров сущностей, отслеживаемых этим контекстом.
    
2. **ContextId** - Уникальный идентификатор для экземпляра контекста и аренды пула, если таковой имеется.
    
3. **Database** - Предоставляет доступ к сведениям и операциям, связанным с базой данных для этого контекста.
    
4. **Model** - Метаданные о форме сущностей, связях между ними и их сопоставлении с базой данных. Может содержать не все сведения, необходимые для инициализации базы данных.
    

## Методы свойства DbContext.DataBase:

1. **EnsureCreated()** - создает базу данных и таблицы в ней
    
2. **EnsureDeleted()** - удаляет базу данных и таблицы в ней
    
3. **CanConnect()** - проверяет доступна ли база данных
    
4. **Migrate()** - производит миграцию базы данных